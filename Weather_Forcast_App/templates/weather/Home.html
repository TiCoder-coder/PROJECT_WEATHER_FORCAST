{% load static %}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Weather Forecast Dashboard</title>
    <link rel="stylesheet" href="{% static 'weather/css/Home.css' %}?v=5821170">

</head>
<body class="home-page">


    <!-- TOP NAV -->
    <header class="home-header">
        <div class="logo">
            <span class="logo-dot"></span>
            <span class="logo-text">VN Weather Hub</span>
        </div>
        <nav class="home-nav">
            <button type="button" class="nav-pill" id="btnIntro">Introduce</button>
        </nav>
    </header>

    <!-- HERO -->
     
    <section class="hero">
        <div class="hero-overlay"></div>
        <div class="wind-layer" aria-hidden="true">
            <span class="wind w1"></span>
            <span class="wind w2"></span>
            <span class="wind w3"></span>
            <span class="wind w4"></span>
            <span class="wind w5"></span>
        </div>
        <div class="hero-anim" aria-hidden="true">
            <!-- SUN -->
            <div class="wx wx-sun">
                <svg class="wx-svg" viewBox="0 0 120 120">
                <g class="sun-rays">
                    <line x1="60" y1="8"  x2="60" y2="22"></line>
                    <line x1="60" y1="98" x2="60" y2="112"></line>
                    <line x1="8"  y1="60" x2="22" y2="60"></line>
                    <line x1="98" y1="60" x2="112" y2="60"></line>
                    <line x1="18" y1="18" x2="28" y2="28"></line>
                    <line x1="92" y1="92" x2="102" y2="102"></line>
                    <line x1="18" y1="102" x2="28" y2="92"></line>
                    <line x1="92" y1="28" x2="102" y2="18"></line>
                </g>
                <circle class="sun-core" cx="60" cy="60" r="22"></circle>
                </svg>
            </div>

            <!-- CLOUD -->
            <div class="wx wx-cloud">
                <svg class="wx-svg" viewBox="0 0 220 140">
                <path class="cloud-fill"
                    d="M78 106h92c18 0 32-12 32-28s-14-28-32-28c-2 0-4 0-6 .3C156 30 139 16 118 16
                    92 16 71 35 71 60c0 1.3.1 2.6.2 3.8C52 66 38 80 38 97c0 16 13 29 40 29z"/>
                <path class="cloud-stroke"
                    d="M78 106h92c18 0 32-12 32-28s-14-28-32-28c-2 0-4 0-6 .3C156 30 139 16 118 16
                    92 16 71 35 71 60c0 1.3.1 2.6.2 3.8C52 66 38 80 38 97c0 16 13 29 40 29z"/>
                </svg>
            </div>

            <!-- RAIN -->
            <div class="wx wx-rain">
                <svg class="wx-svg" viewBox="0 0 240 170">
                <path class="cloud-fill"
                    d="M86 112h102c20 0 36-13 36-31s-16-31-36-31c-2 0-4 0-7 .4C175 27 156 12 132 12
                    102 12 78 34 78 61c0 1.5.1 3 .3 4.4C56 68 40 84 40 103c0 18 15 33 46 33z"/>
                <path class="cloud-stroke"
                    d="M86 112h102c20 0 36-13 36-31s-16-31-36-31c-2 0-4 0-7 .4C175 27 156 12 132 12
                    102 12 78 34 78 61c0 1.5.1 3 .3 4.4C56 68 40 84 40 103c0 18 15 33 46 33z"/>

                <g class="rain-lines">
                    <line x1="88"  y1="124" x2="78"  y2="156"></line>
                    <line x1="120" y1="124" x2="110" y2="162"></line>
                    <line x1="152" y1="124" x2="142" y2="156"></line>
                    <line x1="184" y1="124" x2="174" y2="162"></line>
                </g>
                </svg>
            </div>

            <!-- EARTH (rotating) -->
            <div class="earth-wrap">
                <div class="earth"></div>
                <div class="earth-orbit"></div>
            </div>

            </div>

        <!-- WEATHER ICONS (animated) -->
        <div class="hero-weather" aria-hidden="true">
            <!-- SUN -->
            <div class="wx wx-sun">
            <svg class="wx-svg" viewBox="0 0 120 120">
                <g class="sun-rays">
                <line x1="60" y1="6"  x2="60" y2="20"></line>
                <line x1="60" y1="100" x2="60" y2="114"></line>
                <line x1="6"  y1="60" x2="20" y2="60"></line>
                <line x1="100" y1="60" x2="114" y2="60"></line>

                <line x1="18" y1="18" x2="28" y2="28"></line>
                <line x1="92" y1="92" x2="102" y2="102"></line>
                <line x1="18" y1="102" x2="28" y2="92"></line>
                <line x1="92" y1="28" x2="102" y2="18"></line>

                <line x1="34" y1="10" x2="40" y2="24"></line>
                <line x1="86" y1="96" x2="80" y2="110"></line>
                <line x1="10" y1="86" x2="24" y2="80"></line>
                <line x1="96" y1="34" x2="110" y2="40"></line>
                </g>
                <circle class="sun-core" cx="60" cy="60" r="18"></circle>
            </svg>
            </div>

            <!-- CLOUD -->
            <div class="wx wx-cloud">
            <svg class="wx-svg" viewBox="0 0 220 140">
                <path class="cloud-shape"
                    d="M78 104h92c18 0 32-12 32-28 0-15-12-27-28-28
                        -4-20-22-35-44-35-18 0-33 9-40 22
                        -3-1-7-2-11-2-18 0-33 14-33 31
                        0 3 0 6 1 9C32 78 20 89 20 104c0 16 14 28 31 28h27z"/>
            </svg>
            </div>

            <!-- RAIN -->
            <div class="wx wx-rain">
            <svg class="wx-svg" viewBox="0 0 220 180">
                <path class="cloud-shape"
                    d="M78 86h92c18 0 32-12 32-28 0-15-12-27-28-28
                        -4-20-22-35-44-35-18 0-33 9-40 22
                        -3-1-7-2-11-2-18 0-33 14-33 31
                        0 3 0 6 1 9C32 60 20 71 20 86c0 16 14 28 31 28h27z"/>
                <g class="rain-drops">
                <line x1="70"  y1="120" x2="60"  y2="150"></line>
                <line x1="105" y1="120" x2="95"  y2="155"></line>
                <line x1="140" y1="120" x2="130" y2="150"></line>
                <line x1="175" y1="120" x2="165" y2="155"></line>
                </g>
            </svg>
            </div>
        </div>

        <div class="hero-content">
            <h1>Realtime Vietnam Weather Data</h1>
            <p>
                Collect, merge, and visualize weather data from Vrain and OpenWeather's API-HTML in a single dashboard.
            </p>
            <div class="hero-actions">
                <button type="button" class="btn primary" id="btnOpenCrawlModal">
                    Start crawling Vrain
                </button>
                <a class="btn secondary" href="{% url 'weather:datasets' %}">
                    Recent datasets
                </a>
                <button type="button" class="btn secondary btn-help" id="btnOpenHelpModal">
                    Instructions for use
                </button>

            </div>

            <div class="hero-meta">
                <div class="meta-item">
                    <span class="meta-label">Last updated</span>
                    <span class="meta-value">
                        {{ latest_dataset_time|default:"‚Äî" }}
                    </span>
                </div>
            </div>
        </div>

    </section>

    <!-- OVERVIEW SECTION -->
    <section id="overview" class="section overview">
        <h2>Overview of pipelines</h2>
        <p class="section-desc">
            Each pipeline corresponds to a data source: the international API, Vrain's HTML, or OpenWeather.
        </p>

        <div class="cards">
            <div class="card">
                <div class="card-icon">
                    <img src="{% static 'weather/img/icons/api.svg' %}"
                         alt="API icon"
                         onerror="this.style.display='none'">
                </div>
                <h3>API OpenWeather</h3>
                <p>
                    Use the API to retrieve real-time temperature, humidity, wind, 
                    cloud cover, and other data for the entire country of Vietnam.
                </p>
            </div>

            <div class="card">
                <div class="card-icon">
                    <img src="{% static 'weather/img/icons/vrain.svg' %}"
                         alt="Vrain icon"
                         onerror="this.style.display='none'">
                </div>
                <h3>Vrain ‚Äì HTML/Selenium</h3>
                <p>
                    Crawl rainfall data at each station/vin from the Vrain website 
                    using Selenium, and save it as a CSV/Excel file for analysis.
                </p>
            </div>

            <div class="card">
                <div class="card-icon">
                    <img src="{% static 'weather/img/icons/report.svg' %}"
                         alt="Report icon"
                         onerror="this.style.display='none'">
                </div>
                <h3>Merge & Dashboard</h3>
                <p>
                    Combine data from multiple sources, export to Excel, and prepare 
                    for visualization using Power BI / Grafana / Web chart.
                </p>
            </div>
        </div>
    </section>

    <!-- DATASETS SECTION -->
    <section id="datasets" class="section datasets">
        <h2>Recent data crawls</h2>

        <div class="dataset-grid">
            <div class="dataset-card">
                <h3>API OpenWeather</h3>
                <p>Runs: {{ total_api_runs|default:0 }}</p>
                <span class="badge badge-api">API</span>
            </div>

            <div class="dataset-card">
                <h3>Vrain Crawl</h3>
                <p>Runs: {{ total_vrain_runs|default:0 }}</p>
                <span class="badge badge-vrain">VRAIN</span>
            </div>

        </div>
    </section>

        <!-- ========== MODAL CH·ªåN C√ÅCH CRAWL VRAIN ========== -->
    <div id="crawlMethodModal" class="crawl-modal">
        <div class="crawl-modal__overlay" data-close-crawl-modal></div>

        <div class="crawl-modal__content">
            <header class="crawl-modal__header">
                <h2>Choose how to crawl data using Vrain.</h2>
                <button type="button"
                        class="crawl-modal__close"
                        data-close-crawl-modal>&times;</button>
            </header>


            <div class="crawl-modal__grid">
                <!-- 1. Crawl_data_by_API.py -->
                <div class="crawl-card">
                    <h3>1. Crawl via OpenWeather API</h3>
                    <ul class="crawl-card__list">
                        <li>Retrieve weather data from international APIs (temperature, humidity, wind, rain, etc.).</li>
                        <li>Suitable for getting a nationwide overview.</li>
                    </ul>
                    <button type="button"
                            class="crawl-card__btn"
                            data-crawl-method="api_weather"
                            data-crawl-label="Crawl_data_by_API.py">
                        Choose this method
                    </button>
                </div>

                <!-- 2. Crawl_data_from_Vrain_by_API.py -->
                <div class="crawl-card">
                    <h3>2. Crawl via Vrain API</h3>
                    <ul class="crawl-card__list">
                        <li>Get rainfall data directly from the API (if Vrain provides it).</li>
                        <li>Stable, less dependent on HTML interface.</li>
                    </ul>
                    <button type="button"
                            class="crawl-card__btn"
                            data-crawl-method="vrain_api"
                            data-crawl-label="Crawl_data_from_Vrain_by_API.py">
                        Choose this method
                    </button>
                </div>

                <!-- 3. Crawl_data_from_Vrain_by_Selenium.py -->
                <div class="crawl-card">
                    <h3>3. Crawl Vrain with Selenium (multi-ID)</h3>
                    <ul class="crawl-card__list">
                        <li>Using Selenium to control the browser and read the Vrain UI.</li>
                        <li>Suitable for crawling multiple provinces/stations simultaneously.</li>
                    </ul>
                    <button type="button"
                            class="crawl-card__btn"
                            data-crawl-method="vrain_selenium"
                            data-crawl-label="Crawl_data_from_Vrain_by_Selenium.py">
                        Choose this method
                    </button>
                </div>

                <!-- 4. Crawl_data_from_html_of_Vrain.py -->
                <div class="crawl-card">
                    <h3>4. Crawl HTML Vrain (source analysis)</h3>
                    <ul class="crawl-card__list">
                        <li>Read the HTML and use regex to extract rainfall data for each station.</li>
                        <li>Suitable when fine-tuning HTML parsing logic is required.</li>
                    </ul>
                    <button type="button"
                            class="crawl-card__btn"
                            data-crawl-method="vrain_html"
                            data-crawl-label="Crawl_data_from_html_of_Vrain.py">
                        Choose this method
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- ========== MODAL H∆Ø·ªöNG D·∫™N S·ª¨ D·ª§NG ========== -->
    <div id="helpModal" class="crawl-modal">
        <div class="crawl-modal__overlay" data-close-help-modal></div>

        <div class="crawl-modal__content">
            <header class="crawl-modal__header">
                <h2>üìò Instructions for using VN Weather Hub</h2>
                <button type="button"
                        class="crawl-modal__close"
                        data-close-help-modal>&times;</button>
            </header>

            <div class="help-grid">
                <div class="help-card">
                    <h3>1) Home (Dashboard)</h3>
                    <ul>
                        <li>Click <b>Start crawling Vrain</b> to select pipeline crawl..</li>
                        <li>Scroll down <b>Overview of pipelines</b> to view the description of each pipeline.</li>
                        <li>Scroll down <b>recent datasets</b> to see the number of times each pipeline has been run.</li>
                    </ul>
                </div>

                <div class="help-card">
                    <h3>2) Crawl OpenWeather using the API</h3>
                    <ul>
                        <li>Go to the page <b>Crawl OpenWeather using the API</b>.</li>
                        <li>Click <b>Start crawling Vrain</b> to run script.</li>
                        <li>Logs will be displayed in real-time (if backend logging is enabled).</li>
                        <li>Once finished, the file will be exported to <code>output/</code>.</li>
                    </ul>
                </div>

                <div class="help-card">
                    <h3>3) Crawl Vrain using API</h3>
                    <ul>
                        <li>Go to the page <b>Crawl Vrain using the API</b>.</li>
                        <li>Click <b>Start crawling Vrain</b> to run and monitor the logs.</li>
                        <li>Once finished, the output file will be in the <code>output/</code>.</li>
                    </ul>
                </div>

                <div class="help-card">
                    <h3>4) Crawl Vrain using Selenium / HTML Parse</h3>
                    <ul>
                        <li><b>Selenium</b>: Suitable for crawling by UI/multi-ID.</li>
                        <li><b>HTML Parse</b>: Suitable for fine-tuning logic when parsing HTML source code.</li>
                        <li>Click <b>Start crawling Vrain</b> and see log realtime.</li>
                    </ul>
                </div>

                <div class="help-card help-card--wide">
                    <h3>5) Datasets</h3>
                    <ul>
                        <li>Go to the page <b>Datasets</b> to view the files in <code>output/</code>.</li>
                        <li>Can <b>View</b> or <b>Download</b> depending on the file.</li>
                    </ul>
                </div>
            </div>

            <div class="help-actions">
                <button type="button" class="btn primary" data-close-help-modal>
                    Understood
                </button>
            </div>
        </div>
    </div>


    <footer class="home-footer">
        <span>¬© {{ now|default:"2025" }} Weather Forecast Project ‚Äî Built with Django</span>
    </footer>

<script src="{% static 'weather/js/Home.js' %}?v=96579"></script>

<div id="introModal" class="crawl-modal" aria-hidden="true">
  <div class="crawl-modal__overlay" data-close-intro-modal></div>

  <div class="crawl-modal__content intro-modal__content" role="dialog" aria-modal="true">
    <header class="crawl-modal__header">
      <h2>Introducing VN Weather Hub</h2>
      <button type="button" class="crawl-modal__close" data-close-intro-modal>&times;</button>
    </header>

    <p class="crawl-modal__subtitle">
      The dashboard collects and manages weather data from multiple sources (API + Vrain) in one place.
    </p>

    <div class="intro-body">
      <div class="intro-block">
        <h3>üéØ What does this project do?</h3>
        <ul>
          <li>Crawl weather data according to your chosen pipeline.</li>
          <li>Save the resulting file to the folder <code>output/</code>.</li>
          <li>View and download dataset directly in the section <b>Datasets</b>.</li>
        </ul>
      </div>

      <div class="intro-block">
        <h3>üß© Existing pipelines</h3>
        <ul>
          <li><b>OpenWeather API</b>: get temperature/humidity/wind...</li>
          <li><b>Vrain HTML/Selenium</b>: crawl rainfall data from Vrain.</li>
          <li><b>Vrain API</b>: Obtain rainfall data via API (if available).</li>
        </ul>
      </div>

      <div class="intro-block">
        <h3>üìå How to use quickly</h3>
        <ol>
          <li>Select the pipeline you want to run.</li>
          <li>Click <b>Start crawling Vrain</b> and view the logs in real-time.</li>
          <li>Via <b>Datasets</b> to view/download the latest file.</li>
        </ol>
      </div>

      <div class="intro-block">
        <h3>üí° Suggest</h3>
        <ul>
          <li>If the logs don't appear immediately: check if the script prints log/flush.</li>
          <li>The process finished but the file is missing: check the file path <code>output/</code>.</li>
        </ul>
      </div>
    </div>

    <div class="intro-actions">
      <button type="button" class="btn secondary" data-close-intro-modal>ƒê√≥ng</button>
    </div>
  </div>
</div>

</body>
</html>
